{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nasync function fetchImages(query, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const params = new URLSearchParams({\n    key: '44613226-2c9c9ee480393e9e269050800',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 21,\n  });\n\n  try {\n    const { data } = await axios(`${BASE_URL}?${params}`);\n    const totalHits = data.totalHits;\n    if (totalHits === 0) {\n      urlError();\n      return { images: [], totalHits: 0 };\n    } else {\n      return { images: data.hits, totalHits: totalHits };\n    }\n  } catch (error) {\n    console.error(error.message);\n    throw error;\n  }\n}\n\nconst optionsError = {\n  icon: '',\n  position: 'topRight',\n  messageColor: 'white',\n  close: false,\n  closeOnEscape: true,\n  closeOnClick: true,\n  displayMode: 'replace',\n};\n\nconst urlError = () =>\n  iziToast.error({\n    message:\n      'Sorry, there are no images matching your search query. Please, try again!',\n    backgroundColor: '#CB1E1E',\n    ...optionsError,\n  });\n\nconst showError = () =>\n  iziToast.error({\n    message: 'Please! Type something.',\n    backgroundColor: '#CB1E1E',\n    ...optionsError,\n  });\n\nconst endOfSearchResults = () =>\n  iziToast.error({\n    message: \"We're sorry, but you've reached the end of search results.\",\n    backgroundColor: 'blue',\n    ...optionsError,\n  });\n\nexport { fetchImages, urlError, showError, endOfSearchResults };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\nconst gallery = document.querySelector('.gallery');\n\nfunction renderGallery(images) {\n  gallery.innerHTML = images.map(image => createImageCard(image)).join('');\n  if (lightbox) {\n    lightbox.refresh();\n  } else {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n  }\n}\n\nfunction updateGallery(images) {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    images.map(image => createImageCard(image)).join('')\n  );\n  if (lightbox) {\n    lightbox.refresh();\n  }\n}\n\nfunction createImageCard(image) {\n  return `<li class=\"gallery-item\">\n          <div class=\"gallery-item-image\">\n          <a href=\"${image.largeImageURL}\"><img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" /></a>\n          </div>\n          <ul class=\"image-details\">\n            <li class=\"image-details-item\">\n              <h2 class=\"image-details-title\">Likes</h2>\n              <p class=\"image-details-value\">${image.likes}</p>\n            </li>\n            <li class=\"image-details-item\">\n              <h2 class=\"image-details-title\">Views</h2>\n              <p class=\"image-details-value\">${image.views}</p>\n            </li>\n            <li class=\"image-details-item\">\n              <h2 class=\"image-details-title\">Comments</h2>\n              <p class=\"image-details-value\">${image.comments}</p>\n            </li>\n            <li class=\"image-details-item\">\n              <h2 class=\"image-details-title\">Downloads</h2>\n              <p class=\"image-details-value\">${image.downloads}</p>\n            </li>\n          </ul>\n        </li>`;\n}\n\nfunction showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'none';\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport { renderGallery, updateGallery, showLoader, hideLoader, clearGallery };\n","import {\n  fetchImages,\n  showError,\n  endOfSearchResults,\n} from './js/pixabay-api.js';\nimport {\n  renderGallery,\n  updateGallery,\n  showLoader,\n  hideLoader,\n  clearGallery,\n} from './js/render-functions.js';\n\nconst searchForm = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst loadMore = document.querySelector('.js-load-more');\nconst gallery = document.querySelector('.gallery');\nloadMore.style.display = 'none';\n\nlet page = 1;\nlet totalPages = 0;\nlet currentQuery = '';\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  clearGallery();\n  page = 1;\n  currentQuery = input.value.trim();\n\n  if (currentQuery.length === 0) {\n    showError();\n    loadMore.style.display = 'none';\n    return;\n  }\n\n  showLoader();\n  input.value = '';\n\n  try {\n    const { images, totalHits } = await fetchImages(currentQuery, page);\n    totalPages = Math.ceil(totalHits / 21);\n    renderGallery(images);\n\n    if (totalHits === 0) {\n      loadMore.style.display = 'none';\n    } else if (page >= totalPages) {\n      loadMore.style.display = 'none';\n      endOfSearchResults();\n    } else {\n      loadMore.style.display = 'block';\n    }\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMore.addEventListener('click', async () => {\n  if (!currentQuery) return;\n\n  page += 1;\n  showLoader();\n\n  try {\n    const { images } = await fetchImages(currentQuery, page);\n\n    if (!images || images.length === 0 || page >= totalPages) {\n      hideLoader();\n      endOfSearchResults();\n      loadMore.style.display = 'none';\n      return;\n    }\n\n    updateGallery(images);\n\n    const lastCard = gallery.lastElementChild;\n    const cardHeight = lastCard.getBoundingClientRect().height;\n\n    window.scrollBy({\n      left: 0,\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.error(error.message);\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["fetchImages","query","page","BASE_URL","params","data","axios","totalHits","urlError","error","optionsError","iziToast","showError","endOfSearchResults","lightbox","gallery","renderGallery","images","image","createImageCard","SimpleLightbox","updateGallery","showLoader","loader","hideLoader","clearGallery","searchForm","input","loadMore","totalPages","currentQuery","event","cardHeight"],"mappings":"+vBAIA,eAAeA,EAAYC,EAAOC,EAAO,EAAG,CAC1C,MAAMC,EAAW,2BACXC,EAAS,IAAI,gBAAgB,CACjC,IAAK,qCACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EACd,CAAG,EAED,GAAI,CACF,KAAM,CAAE,KAAAG,GAAS,MAAMC,EAAM,GAAGH,CAAQ,IAAIC,CAAM,EAAE,EAC9CG,EAAYF,EAAK,UACvB,OAAIE,IAAc,GAChBC,IACO,CAAE,OAAQ,CAAA,EAAI,UAAW,CAAC,GAE1B,CAAE,OAAQH,EAAK,KAAM,UAAWE,CAAS,CAEnD,OAAQE,EAAO,CACd,cAAQ,MAAMA,EAAM,OAAO,EACrBA,CACP,CACH,CAEA,MAAMC,EAAe,CACnB,KAAM,GACN,SAAU,WACV,aAAc,QACd,MAAO,GACP,cAAe,GACf,aAAc,GACd,YAAa,SACf,EAEMF,EAAW,IACfG,EAAS,MAAM,CACb,QACE,4EACF,gBAAiB,UACjB,GAAGD,CACP,CAAG,EAEGE,EAAY,IAChBD,EAAS,MAAM,CACb,QAAS,0BACT,gBAAiB,UACjB,GAAGD,CACP,CAAG,EAEGG,EAAqB,IACzBF,EAAS,MAAM,CACb,QAAS,6DACT,gBAAiB,OACjB,GAAGD,CACP,CAAG,EC1DH,IAAII,EACJ,MAAMC,EAAU,SAAS,cAAc,UAAU,EAEjD,SAASC,EAAcC,EAAQ,CAC7BF,EAAQ,UAAYE,EAAO,IAAIC,GAASC,EAAgBD,CAAK,CAAC,EAAE,KAAK,EAAE,EACnEJ,EACFA,EAAS,QAAO,EAEhBA,EAAW,IAAIM,EAAe,aAAc,CAC1C,aAAc,IACd,aAAc,KACpB,CAAK,CAEL,CAEA,SAASC,EAAcJ,EAAQ,CAC7BF,EAAQ,mBACN,YACAE,EAAO,IAAIC,GAASC,EAAgBD,CAAK,CAAC,EAAE,KAAK,EAAE,CACvD,EACMJ,GACFA,EAAS,QAAO,CAEpB,CAEA,SAASK,EAAgBD,EAAO,CAC9B,MAAO;AAAA;AAAA,qBAEYA,EAAM,aAAa,eAAeA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,+CAK9CA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,+CAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,+CAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,+CAIdA,EAAM,SAAS;AAAA;AAAA;AAAA,cAI9D,CAEA,SAASI,GAAa,CACpB,MAAMC,EAAS,SAAS,cAAc,SAAS,EAC/CA,EAAO,MAAM,QAAU,OACzB,CAEA,SAASC,GAAa,CACpB,MAAMD,EAAS,SAAS,cAAc,SAAS,EAC/CA,EAAO,MAAM,QAAU,MACzB,CAEA,SAASE,GAAe,CACtBV,EAAQ,UAAY,EACtB,CCrDA,MAAMW,EAAa,SAAS,cAAc,OAAO,EAC3CC,EAAQ,SAAS,cAAc,QAAQ,EACvCC,EAAW,SAAS,cAAc,eAAe,EACjDb,EAAU,SAAS,cAAc,UAAU,EACjDa,EAAS,MAAM,QAAU,OAEzB,IAAI1B,EAAO,EACP2B,EAAa,EACbC,EAAe,GAEnBJ,EAAW,iBAAiB,SAAU,MAAMK,GAAS,CAMnD,GALAA,EAAM,eAAc,EACpBN,IACAvB,EAAO,EACP4B,EAAeH,EAAM,MAAM,OAEvBG,EAAa,SAAW,EAAG,CAC7BlB,IACAgB,EAAS,MAAM,QAAU,OACzB,MACD,CAEDN,IACAK,EAAM,MAAQ,GAEd,GAAI,CACF,KAAM,CAAE,OAAAV,EAAQ,UAAAV,CAAW,EAAG,MAAMP,EAAY8B,EAAc5B,CAAI,EAClE2B,EAAa,KAAK,KAAKtB,EAAY,EAAE,EACrCS,EAAcC,CAAM,EAEhBV,IAAc,EAChBqB,EAAS,MAAM,QAAU,OAChB1B,GAAQ2B,GACjBD,EAAS,MAAM,QAAU,OACzBf,KAEAe,EAAS,MAAM,QAAU,OAE5B,OAAQnB,EAAO,CACd,QAAQ,IAAIA,EAAM,OAAO,CAC7B,QAAY,CACRe,GACD,CACH,CAAC,EAEDI,EAAS,iBAAiB,QAAS,SAAY,CAC7C,GAAKE,EAEL,CAAA5B,GAAQ,EACRoB,IAEA,GAAI,CACF,KAAM,CAAE,OAAAL,CAAM,EAAK,MAAMjB,EAAY8B,EAAc5B,CAAI,EAEvD,GAAI,CAACe,GAAUA,EAAO,SAAW,GAAKf,GAAQ2B,EAAY,CACxDL,IACAX,IACAe,EAAS,MAAM,QAAU,OACzB,MACD,CAEDP,EAAcJ,CAAM,EAGpB,MAAMe,EADWjB,EAAQ,iBACG,sBAAqB,EAAG,OAEpD,OAAO,SAAS,CACd,KAAM,EACN,IAAKiB,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,OAAQvB,EAAO,CACd,QAAQ,MAAMA,EAAM,OAAO,CAC/B,QAAY,CACRe,GACD,EACH,CAAC"}